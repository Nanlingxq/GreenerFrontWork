import{S,d as q,_ as A,r as p,a as h,c as P,b as o,e as t,w as i,f as c,E as V,u as B,o as E,g as m,h as y,l as f}from"./index-Z29Ueo0M.js";const C=""+new URL("icon2-Dg24UnLv.png",import.meta.url).href,L=""+new URL("icon1-D-fpjmAM.png",import.meta.url).href,M=s=>{const l=document.querySelector(".pre-box"),r=document.querySelector("#avatar");s?(l.style.transform="translateX(100%)",l.style.backgroundColor="#9ee6aa",r.src=L):(l.style.transform="translateX(0%)",l.style.backgroundColor="#19b96e",r.src=C)},D=s=>S({...s,method:"get",params:s.data}),I=s=>S({...s,method:"post",data:s.data}),F={get:D,post:I},N=s=>F.post({url:"/api/login",data:s}),X=s=>F.post({url:"/api/register",data:s}),k={loginApi:N,registerApi:X},j=q("loginStore",{state:()=>({flag:!0}),actions:{toggleFlag(){this.flag=!this.flag}},persist:!0}),$={class:"bigBox"},z={class:"box",ref:"box"},G={class:"register-form"},H={class:"login-form"},J={__name:"login",setup(s){const l=p({username:"",password:""}),r=p({username:"",password:"",confirmPassword:""}),g=h(""),b=h(""),x=p({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:5,message:"长度应该在3~5个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"长度应该大于6",trigger:"blur"}],confirmPassword:[{required:!0,message:"请输入确认密码",trigger:"blur"},{min:6,message:"长度应该大于6",trigger:"blur"}]}),_=B(),w=()=>{const n=j();M(n.flag),n.toggleFlag()},U=()=>{_.push({name:"home"}),g.value.validate(n=>{if(n)k.loginApi(l).then(e=>{console.log("login",e),e.status===0&&(V.success(e.message),window.sessionStorage.setItem("token",e.token),_.push("/home"))}).catch(e=>{console.log(e)});else return})},R=()=>{b.value.validate(n=>{if(n)k.registerApi(r).then(e=>{e.status===0&&V.success(e.message)}).catch(e=>{console.log(e)});else return})};return(n,e)=>{const u=c("el-input"),d=c("el-form-item"),v=c("el-form");return E(),P("div",$,[o("div",z,[e[7]||(e[7]=o("div",{class:"pre-box"},[o("h1",null,"欢迎访问"),o("p",null,"我们的环保网站!"),o("div",{class:"img-box"},[o("img",{src:C,alt:"",id:"avatar"})])],-1)),o("div",G,[e[5]||(e[5]=o("div",{class:"title-box"},[o("h1",null,"注册")],-1)),t(v,{ref_key:"registerFormRef",ref:b,model:r,rules:x,"label-with":"5px"},{default:i(()=>[t(d,{prop:"username",label:" "},{default:i(()=>[t(u,{type:"text",placeholder:"用户名","suffix-icon":m(y),modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=a=>r.username=a)},null,8,["suffix-icon","modelValue"])]),_:1}),t(d,{prop:"password",label:" "},{default:i(()=>[t(u,{type:"password",placeholder:"密码","suffix-icon":m(f),modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=a=>r.password=a)},null,8,["suffix-icon","modelValue"])]),_:1}),t(d,{prop:"confirmPassword",label:" "},{default:i(()=>[t(u,{type:"password",placeholder:"确认密码","suffix-icon":m(f),modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=a=>r.confirmPassword=a)},null,8,["suffix-icon","modelValue"])]),_:1})]),_:1},8,["model","rules"]),o("div",{class:"btn-box"},[o("button",{onClick:R},"注册"),o("p",{onClick:w},"已有账号?去登录")])]),o("div",H,[e[6]||(e[6]=o("div",{class:"title-box"},[o("h1",null,"登录")],-1)),t(v,{ref_key:"loginFormRef",ref:g,model:l,rules:x,"label-with":"5px"},{default:i(()=>[t(d,{prop:"username",label:" "},{default:i(()=>[t(u,{type:"text",placeholder:"用户名","suffix-icon":m(y),modelValue:l.username,"onUpdate:modelValue":e[3]||(e[3]=a=>l.username=a)},null,8,["suffix-icon","modelValue"])]),_:1}),t(d,{prop:"password",label:" "},{default:i(()=>[t(u,{type:"password",placeholder:"密码","suffix-icon":m(f),modelValue:l.password,"onUpdate:modelValue":e[4]||(e[4]=a=>l.password=a)},null,8,["suffix-icon","modelValue"])]),_:1})]),_:1},8,["model","rules"]),o("div",{class:"btn-box"},[o("button",{onClick:U},"登录"),o("p",{onClick:w},"没有账号?去注册")])])],512)])}}},O=A(J,[["__scopeId","data-v-18fcb411"]]);export{O as default};
